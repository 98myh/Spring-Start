<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{/layout/basic :: setContent(~{this:: content})}">
  <th:block th:fragment="content">
    <h1>GuestBook List Page
      <span>
        <a th:href="@{/guestbook/register}" class="btn btn-outline-primary">REGISTER</a>
      </span>
    </h1>
    <table class="table table-striped">
      <thead>
      <tr>
        <th scope="col">Gno</th>
        <th scope="col">Title</th>
        <th scope="col">Writer</th>
        <th scope="col">Regdate</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="dto : ${result.dtoList}">
        <th scope="row">[[${dto.gno}]]</th>
        <th scope="row">[[${dto.title}]]</th>
        <th scope="row">[[${dto.writer}]]</th>
        <th scope="row">[[${#temporals.format(dto.regDate,'yyyy/MM/dd')}]]</th>
      </tr>
      </tbody>
    </table>
    <ul class="pagination h-100 justify-content-center align-items-center">
      <li class="page-item " th:if="${result.prev}">
        <a class="page-link" th:href="@{/guestbook/list(page=${result.start-1})}" tabindex="-1">Previous</a>
      </li>
      <li th:class=" 'page-item ' + ${result.page == page?'active':''} " th:each="page:${result.pageList}">
        <a class="page-link" th:href="@{/guestbook/list(page=${page})}">[[${page}]]</a>
      </li>
      <li class="page-item " th:if="${result.next}">
        <a class="page-link" th:href="@{/guestbook/list(page=${result.end+1})}">Next</a>
      </li>
    </ul>
    <div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
          </div>
        </div>
      </div>
    </div>
    <script th:inline="javascript">
      window.onload = function () {
        var msg = /*[[${msg}]]*/'msg'; console.log(msg);
        if (msg) {
          const gno = msg.split(" ")[0]; const noti = msg.split(" ")[1];
          const myModal = new bootstrap.Modal(document.getElementById('myModal'), { backdrop: true });
          document.querySelector(".modal-title").textContent = noti + ' 완료';
          document.querySelector(".modal-body").innerHTML = `<p>${gno}번 글이 ${noti} 되었습니다.</p>`;
          myModal.show()
        }

        const srchFrm = document.querySelector('#srchFrm');
        const srchBtn = document.querySelector('#srchFrm .srchBtn');
        const clearBtn = document.querySelector('#srchFrm .clearBtn');
        const selectType = document.querySelector('#srchFrm select[name="type"]');
        const textKeyword = document.querySelector('#srchFrm input[name="keyword"]');
        srchBtn.onclick = () => {
          srchFrm.submit();
        }
        clearBtn.onclick = function () {
          selectType.options[0].selected = true;
          textKeyword.value = "";
        }
        selectType.onchange = function () {
          if(selectType.options[0].selected == true){
            textKeyword.disabled = true;
            textKeyword.value="";
          } else {
            textKeyword.disabled = false;
          }
        }
        const requestKeyword = /*[[${pageRequestDTO.keyword}]]*/'keyword';
        textKeyword.disabled = requestKeyword==null?true:(requestKeyword.trim() == "")?true:false;
      }
    </script>
  </th:block>
</th:block>